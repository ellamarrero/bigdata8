---
title: "Homework 1"
author: "Ella Marrero, David Morales, Brandon Powell"
date: `r lubridate::today()`
output: html_document
---

```{r setup, include=FALSE}
# load necessary libraries
library(tidyverse)
library(tidymodels)
library(lubridate)

# load data

# table with review subset, including product type, user id, score, length, etc. 
reviews <- read.table("https://codowd.com/bigdata/hw1/Review_subset.csv", header = TRUE)

# simple triplet matrix of word counts from the review text 
doc_word <- read.table("https://codowd.com/bigdata/hw1/word_freq.csv", header = FALSE)
colnames(doc_word) = c("review_id","word_id","times_word")

# 1125 alphabetically ordered words that occur in the reviews
words <- read.table("https://codowd.com/bigdata/hw1/words.csv", header = F)
words <- words[,1]

# set option chunks
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
  )
```

```{r tidy, include = FALSE}
# create a matrix fo word presence
spm <- matrix(0L, nrow = nrow(reviews),ncol=length(words))
for (i in 1:nrow(doc_word)) { 
  r_id <- doc_word[i,1]
  w_id <- doc_word[i,2]
  # spm[review id, word, id] = times word 
  spm[r_id, w_id] <- doc_word[i,3]
}

colnames(spm) = words
dim(spm)
```

```{r}
spm <- matrix(0L, nrow = nrow(reviews),ncol=length(words))
get_revid <- function(index){
  r_id <- doc_word[index,1]
  w_id <- doc_word[index,2]
  # spm[review id, word, id] = times word 
  spm[r_id, w_id] <- doc_word[index,3]
  print(spm[r_id, w_id])
  
}
fill_spm <- sapply(1:nrow(doc_word), get_revid)
```

## Q1 Plot the p-values and comment on their distribution (2 sentence max). 

## Q2 Let's do standard statistical testing. How many tests are significant at the alpha level 0.05 and 0.01?

## Q3 What is the p-value cutoff for 1% FDR? Plot the rejection region. 

## Q4 How many discoveries do you find at q=0.01 and how many do you expect to be false? 

## Q5 What are the 10 most significant words? Was 'addictive' significant'? Do these results make sense to you? (2 sentence max) 

## Q6 What are the advantages and disadvantages of our FDR anaysis? (4 sentence max) 


